# üß´ 3. Explore effect of interactions as a function of media composition

We have already simulated the effect of switching carbon sources on the metabolic interactions. In this exercise we will further explore modifications to the media by tweaking the amino acid supply in the environment.

## ü•º Run 3 additional computational experiments

Run each simulation on your own machine as shown in the following code chunks.

#### ü•¶ Low amino acid environment with lactose as carbon source

First, let's see what would happen in a low amino acid environment. We have already created a modified CDM35 with lactose as a carbon source and without all amino acids except for Valine. Note that ornithine and nh4 are also present as nitrogen sources.


```bash
$ smetana -v -d --flavor cobra --mediadb $ROOT/media.tsv -m CDM35_low_AA_lcts -o $ROOT/CDM35_low_AA_lcts $ROOT/models/*.xml && paste $ROOT/CDM35_low_AA_lcts_detailed.tsv
```
  
#### üçÖ Low amino acid environment with glucose as carbon source

Now let's see what would happen in a low amino acid environment (only valine) with glucose as a carbon source. Note that ornithine and nh4 are also present as nitrogen sources.

```bash
$ smetana -v -d --flavor cobra --mediadb $ROOT/media.tsv -m CDM35_low_AA_glc -o $ROOT/CDM35_low_AA_glc $ROOT/models/*.xml && paste $ROOT/CDM35_low_AA_glc_detailed.tsv
```
  
#### üçÜ Low amino acid environment with galactose as carbon source

Now let's see what would happen in a low amino acid environment (only valine) with galactose as a carbon source. Note that ornithine and nh4 are also present as nitrogen sources.

```bash
$ smetana -v -d --flavor cobra --mediadb $ROOT/media.tsv -m CDM35_low_AA_gal -o $ROOT/CDM35_low_AA_gal $ROOT/models/*.xml && paste $ROOT/CDM35_low_AA_gal_detailed.tsv
```

## üì∫ Visualizing interactions

Alluvial diagrams, AKA sankey or flow diagrams, are a quick and easy way to visualize interaction predictions generated by SMETANA. We provide the following Rscript to be used for plotting your generated results. 

<details>
    <summary>Click to see Rscript</summary>

https://github.com/franciscozorrilla/EMBOMicroCom/blob/905fb9fc674d2af731fc978079597f6027b15c1a/plot_interactions.R#L1-L23

  </details>

To start plotting your own data, open Rstudio and navigate to your `$ROOT` folder in the bottom right file explorer. Click on the little gear button labeled `More` and set your current folder as the working directory. Then click on the `plot_interactions.R` script, which should bring up the code. Now you may run the script with the default parameters to generate an alluvial diagram.
    
The script is hardcoded to read the CDM35 lactose SMETANA results file `CDM35_lcts_detailed.tsv` and plot to a file called `CDM35_lcts.pdf`. After generating prediction for each media condition, modify these parameters to read in and generate plots for each of the above experimental conditions. You may also have a look at some [precomputed results](https://github.com/franciscozorrilla/EMBOMicroCom/blob/main/exercises/precomputed_simulations.md) for comparison, or if you run into any trouble generating results of your own.

## üíé Discussion questions

* How does switching carbon source affect the metabolic interactions between yeast and bacteria in this new low amino acid media?
* Modify the media composition you created in the last exercise by replacing glucose/lactose/galactose with a new carbon source, e.g. trehalose, maltose, etc. Now remove all amino acids except valine and simulate interactions with SMETANA. How do the interactions compare in this new scenario?
* If time allows, simulate the two species in [milk media](https://github.com/cdanielmachado/kefir_paper/blob/master/misc_data/milk_composition.tsv) from a kefir study. Are any interactions predicted? Why / why not? Can you modify the media to force interactions?

## Move on to [exercise 4](https://github.com/franciscozorrilla/EMBOMicroCom/blob/main/exercises/exercise_4.md)
